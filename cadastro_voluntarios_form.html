<!doctype html>
<html lang="pt-BR">
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width,initial-scale=1">
  <title>Cadastro de Voluntários — Expedições Arqueológicas Digitais</title>
  <style>
    :root{font-family:system-ui,-apple-system,Segoe UI,Roboto,"Helvetica Neue",Arial;line-height:1.45}
    body{max-width:980px;margin:2rem auto;padding:1rem}
    header{margin-bottom:1rem}
    form{background:#fff;border:1px solid #e6e6e6;padding:1rem;border-radius:8px}
    fieldset{margin-bottom:1rem;border:1px solid #ddd;padding:1rem;border-radius:6px}
    legend{font-weight:700;padding:0 6px}
    label{display:block;margin-bottom:.25rem;font-weight:600}
    .row{display:flex;gap:1rem}
    .col{flex:1;min-width:180px}
    input,select,textarea,button{width:100%;padding:.5rem;border:1px solid #ccc;border-radius:6px}
    .help{font-size:.85rem;color:#555;margin-top:.25rem}
    .small{font-size:.85rem}
    .controls{display:flex;gap:.5rem;flex-wrap:wrap}
    .checkboxes label{display:inline-flex;align-items:center;gap:.5rem;margin-right:1rem}
    .visually-hidden{position:absolute!important;height:1px;width:1px;overflow:hidden;clip:rect(1px,1px,1px,1px);white-space:nowrap;border:0;padding:0;margin:-1px}
    pre{background:#f7f7f7;border-radius:6px;padding:1rem;overflow:auto}
    .actions{display:flex;gap:.5rem;align-items:center}
  </style>
</head>
<body>
  <header>
    <h1>Formulário de Cadastro de Voluntários</h1>
    <p class="small">Preencha o formulário para se inscrever nas futuras expedições. Campos marcados com <abbr title="obrigatório">*</abbr> são obrigatórios.</p>
  </header>

  <form id="volunteerForm" novalidate aria-describedby="form-instructions">
    <p id="form-instructions" class="help">Use Tab para navegar — o formulário é compatível com leitores de tela. Ao enviar, verá uma pré-visualização dos dados (não será enviado para servidor nesta demo).</p>

    <fieldset>
      <legend>Informações Pessoais</legend>
      <div class="row">
        <div class="col">
          <label for="fullName">Nome completo <span aria-hidden="true">*</span></label>
          <input id="fullName" name="fullName" type="text" required autocomplete="name" placeholder="Ex.: Maria Silva" />
          <div class="help">Nome como consta em documentos oficiais.</div>
        </div>
        <div class="col">
          <label for="preferredName">Nome preferido</label>
          <input id="preferredName" name="preferredName" type="text" autocomplete="nickname" placeholder="Como prefere ser chamada" />
        </div>
      </div>

      <div class="row">
        <div class="col">
          <label for="email">E-mail <span aria-hidden="true">*</span></label>
          <input id="email" name="email" type="email" required autocomplete="email" placeholder="nome@exemplo.com" />
        </div>
        <div class="col">
          <label for="phone">Telefone (celular) <span aria-hidden="true">*</span></label>
          <input id="phone" name="phone" type="tel" required pattern="\\+?\\d{8,15}" placeholder="+55 81999999999" aria-describedby="phoneHelp" />
          <div id="phoneHelp" class="help">Formato internacional recomendado. Apenas números e +.</div>
        </div>
      </div>

      <div class="row">
        <div class="col">
          <label for="birthdate">Data de nascimento <span aria-hidden="true">*</span></label>
          <input id="birthdate" name="birthdate" type="date" required aria-describedby="ageOutput" />
          <div class="help">Você precisa ter 18 anos ou mais para participar.</div>
        </div>
        <div class="col">
          <label for="ageOutput">Idade calculada</label>
          <output id="ageOutput" name="age">—</output>
        </div>
      </div>

      <div class="row">
        <div class="col">
          <label>Gênero</label>
          <div role="radiogroup" aria-labelledby="genderLabel">
            <span id="genderLabel" class="visually-hidden">Opções de gênero</span>

            <label><input type="radio" name="gender" value="female"> Feminino</label>
            <label><input type="radio" name="gender" value="male"> Masculino</label>
            <label><input type="radio" name="gender" value="preferNot"> Prefiro não dizer</label>
          </div>
        </div>

        <div class="col">
          <label for="pronouns">Pronomes</label>
          <select id="pronouns" name="pronouns">
            <option value="">Selecionar</option>
            <option value="ela">Ela/dela</option>
            <option value="ele">Ele/dele</option>
            <option value="elu">Elu/delu</option>
            <option value="outro">Outro</option>
          </select>
        </div>
      </div>
    </fieldset>

    <fieldset>
      <legend>Informações de contato de emergência</legend>
      <div class="row">
        <div class="col">
          <label for="emergencyName">Nome do contato de emergência <span aria-hidden="true">*</span></label>
          <input id="emergencyName" name="emergencyName" type="text" required />
        </div>
        <div class="col">
          <label for="emergencyPhone">Telefone do contato <span aria-hidden="true">*</span></label>
          <input id="emergencyPhone" name="emergencyPhone" type="tel" required pattern="\\+?\\d{8,15}" />
        </div>
      </div>
    </fieldset>

    <fieldset>
      <legend>Habilidades, disponibilidade e experiência</legend>

      <label for="skills">Habilidades / Áreas de interesse (separe por vírgula)</label>
      <input id="skills" name="skills" type="search" list="skillsList" placeholder="ex.: mapeamento, catalogação, fotogrametria" />
      <datalist id="skillsList">
        <option value="Catalogação"></option>
        <option value="Fotografia"></option>
        <option value="Drones e fotogrametria"></option>
        <option value="GIS / mapeamento"></option>
        <option value="Conservação"></option>
      </datalist>

      <label for="languages">Idiomas (segure Ctrl / Cmd para múltipla seleção)</label>
      <select id="languages" name="languages" multiple size="4" aria-describedby="languagesHelp">
        <option value="pt">Português</option>
        <option value="en">Inglês</option>
        <option value="es">Espanhol</option>
        <option value="fr">Francês</option>
        <option value="other">Outro</option>
      </select>
      <div id="languagesHelp" class="help">Indique os idiomas que domina.</div>

      <div class="row" style="margin-top:.5rem">
        <div class="col">
          <label for="yearsExperience">Anos de experiência em campo</label>
          <input id="yearsExperience" name="yearsExperience" type="number" min="0" max="50" step="1" value="0" />
        </div>
        <div class="col">
          <label for="rolePreference">Funções de interesse</label>
          <div class="checkboxes controls" id="rolePreference">
            <label><input type="checkbox" name="role" value="fieldwork"> Trabalho de campo</label>
            <label><input type="checkbox" name="role" value="cataloging"> Catalogação</label>
            <label><input type="checkbox" name="role" value="photography"> Fotografia</label>
            <label><input type="checkbox" name="role" value="gis"> GIS / Mapeamento</label>
            <label><input type="checkbox" name="role" value="conservation"> Conservação</label>
          </div>
        </div>
      </div>

      <label for="availabilityDate">Próxima data disponível</label>
      <input id="availabilityDate" name="availabilityDate" type="datetime-local" />

      <label for="hoursPerWeek">Horas disponíveis por semana</label>
      <input id="hoursPerWeek" name="hoursPerWeek" type="range" min="0" max="40" value="10" oninput="this.nextElementSibling.value=this.value"> <output>10</output>

      <label for="portfolio">Portfólio / Site pessoal (opcional)</label>
      <input id="portfolio" name="portfolio" type="url" placeholder="https://exemplo.com" />

    </fieldset>

    <fieldset>
      <legend>Saúde, acessibilidade e logística</legend>
      <label for="diet">Restrições alimentares</label>
      <input id="diet" name="diet" type="text" placeholder="ex.: vegetariano, sem glúten" />

      <label for="allergies">Alergias e condições médicas relevantes</label>
      <textarea id="allergies" name="allergies" rows="3" placeholder="Descreva alergias, medicações em uso, etc."></textarea>

      <label for="wheelchair">Necessita de acessibilidade (cadeira de rodas)?</label>
      <select id="wheelchair" name="wheelchair">
        <option value="no">Não</option>
        <option value="yes">Sim</option>
        <option value="maybe">Talvez / Precisa de avaliação</option>
      </select>

      <label for="tshirt">Tamanho da camiseta (oferecida em expedições)</label>
      <select id="tshirt" name="tshirt" required>
        <option value="">Selecionar</option>
        <option value="XS">XS</option>
        <option value="S">S</option>
        <option value="M">M</option>
        <option value="L">L</option>
        <option value="XL">XL</option>
      </select>

      <label for="certificates">Anexar certificados / atestados (PDF, JPG) — máximo 5 MB</label>
      <input id="certificates" name="certificates" type="file" accept="application/pdf,image/*" multiple aria-describedby="fileHelp" />
      <div id="fileHelp" class="help">Envie certificados ou comprovantes relevantes (opcional).</div>

    </fieldset>

    <fieldset>
      <legend>Consentimentos e confirmação</legend>
      <div class="controls">
        <label><input id="agree" name="agree" type="checkbox" required> Li e concordo com os termos de participação e o código de conduta. <span class="small">*</span></label>
      </div>

      <label for="signature">Assinatura eletrônica (digite seu nome)</label>
      <input id="signature" name="signature" type="text" placeholder="Digite seu nome para assinar" required />

      <input type="hidden" name="referral" value="site_campanha" />

    </fieldset>

    <div class="actions">
      <button type="submit">Enviar inscrição</button>
      <button type="reset">Limpar</button>
      <div aria-live="polite" id="status" class="help"></div>
    </div>

    <hr />

    <section aria-labelledby="previewHeading">
      <h2 id="previewHeading">Pré-visualização (JSON)</h2>
      <pre id="preview" role="region" aria-live="polite">{ }</pre>
    </section>
  </form>

  <script>
    const form = document.getElementById('volunteerForm');
    const preview = document.getElementById('preview');
    const status = document.getElementById('status');
    const ageOutput = document.getElementById('ageOutput');

    function calculateAge(dateString) {
      if (!dateString) return null;
      const today = new Date();
      const birth = new Date(dateString);
      let age = today.getFullYear() - birth.getFullYear();
      const m = today.getMonth() - birth.getMonth();
      if (m < 0 || (m === 0 && today.getDate() < birth.getDate())) age--;
      return age;
    }

    document.getElementById('birthdate').addEventListener('change', (e) => {
      const age = calculateAge(e.target.value);
      ageOutput.value = age !== null ? age + ' anos' : '—';
      if (age !== null && age < 18) {
        e.target.setCustomValidity('É necessário ter 18 anos ou mais para participar.');
      } else {
        e.target.setCustomValidity('');
      }
    });

    form.addEventListener('submit', (ev) => {
      ev.preventDefault();
      status.textContent = '';

      // Built-in form validation
      if (!form.checkValidity()) {
        form.reportValidity();
        status.textContent = 'Existem campos inválidos. Verifique e tente novamente.';
        return;
      }

      // Collect form data into an object
      const data = new FormData(form);
      const obj = {};
      for (const [key, value] of data.entries()) {
        if (Object.prototype.hasOwnProperty.call(obj, key)) {
          // convert to array if multiple
          if (!Array.isArray(obj[key])) obj[key] = [obj[key]];
          obj[key].push(value);
        } else {
          obj[key] = value;
        }
      }

      // Attach files metadata (names and sizes) instead of full binary data
      const filesInput = document.getElementById('certificates');
      if (filesInput && filesInput.files.length) {
        obj.certificates = [];
        for (const f of filesInput.files) obj.certificates.push({name: f.name, size: f.size});
      }

      preview.textContent = JSON.stringify(obj, null, 2);
      status.textContent = 'Pré-visualização atualizada — nenhum dado foi enviado para servidor nesta demo.';

      // Optional: here you would send 'obj' to your API with fetch().
    });

    // Live preview on change for accessibility/testing
    form.addEventListener('input', () => {
      const data = new FormData(form);
      const obj = {};
      for (const [k, v] of data.entries()) {
        if (Object.prototype.hasOwnProperty.call(obj, k)) {
          if (!Array.isArray(obj[k])) obj[k] = [obj[k]];
          obj[k].push(v);
        } else obj[k] = v;
      }
      preview.textContent = JSON.stringify(obj, null, 2);
    });
  </script>
</body>
</html>